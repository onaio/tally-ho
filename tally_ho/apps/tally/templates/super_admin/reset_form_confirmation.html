{% extends 'base.html' %}

{% load i18n %}

{% block content %}

<h1>{% trans 'Reset Form to Unsubmitted' %}</h1>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{% if message.tags == 'error' %}danger{% elif message.tags == 'success' %}success{% elif message.tags == 'warning' %}warning{% else %}info{% endif %} alert-dismissible fade in" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<form name="reset-form-confirmation-form" method="post" action="">

<div class="alert alert-info">
    <strong>{% trans 'Form State' %}:</strong> {{ current_state }}
</div>

{% if is_already_unsubmitted %}
    <div class="alert alert-warning">
        <strong>{% trans 'Notice:' %}</strong>
        {% trans 'This form is already in UNSUBMITTED state. Form Reset is not required.' %}
    </div>
{% else %}
    <div class="alert alert-warning">
        <strong>{% trans 'Warning!' %}</strong>
        {% trans 'This will reset the form to UNSUBMITTED state and deactivate all related records (results, reconciliation forms, audits, clearances, and quality control records).' %}
    </div>
{% endif %}

<div class="container">
    {% include 'center_details.html' %}
</div>
<a href="{% url 'result-form-history' tally_id=tally_id %}" >{% trans "View Result Form History" %}</a>

{% if not is_already_unsubmitted %}
    <div class="form-group">
        {% trans form.reject_reason.label %}
        {{ form.reject_reason }}
        {% if form.reason.errors %}
            <div class="alert alert-danger">
                {{ form.reject_reason.errors }}
            </div>
        {% endif %}
    </div>

    <input type="hidden" name="next" value="{{ next }}">
    <button type="submit" name="reset_submit" class="btn btn-small btn-warning">{% trans "Reset to Unsubmitted" %}</button>
    <button type="submit" name="abort_submit" class="btn btn-small btn-default">{% trans "Cancel" %}</button>    
    {% csrf_token %}
{% endif %}
</form>

{% endblock %}
