{% extends 'base.html' %}

{% load i18n %}

{% block content %}
<div class="page-header">
<h1>{% trans 'Data Entry' %} {{ data_entry_number }}</h1>
    </div>

{% include 'center_details.html' %}

<form name="results" method="post" action="" onsubmit="return validate_results('{% trans "Some fields are blank!" %}');">
    {{ reconciliation_form.errors }}
    {{ reconciliation_form.non_form_errors }}
    {% if result_form.has_recon %}
    <h2>{% trans 'Reconciliation section' %}</h2>
    <hr>
    <br>
    <div class="row">
        <div class="text-center">
            <p class="gray-bg">{% trans 'In all the fields below, please check the number of ballots twice to ensure accuracy' %}</p >
            <p class="gray-bg">{% trans 'Section (A) to be filled prior to opening the polling station' %}</p>
        </div>
    </div>
	<div class="row">
		<table class="table table-bordered">
		<tbody>
		<tr>
			<th width="10%"><span class="bignum">1</span></th>
            <th width="70%">
                <label for="id_number_ballots_received">
                <span class="helptext">{% trans 'Total number of ballots papers received by the polling station' %} </span></label></th>
			<td width="20%" class="pink-bg required-input"><input tabindex="10" autocomplete="off" class="pink-bg form-control" id="id_number_ballots_received" name="number_ballots_received" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"></td>
		</tr>
		</tbody>
		</table>
	</div>
    <div class="row">
        <div class="text-center">
            <p class="gray-bg">{% trans 'Section (B) reconciliation of the number of voter cards with ballot papers' %}</p>
        </div>
        <div class="col-md-2 col-sm-1 grid2">
           <table class="table table-bordered">
		    <tbody>
                <tr>
                    <th width="10%"><span class="bignum">9</span></th>
                    <th width="60%"><label for="id_total_of_cancelled_ballots_and_ballots_inside_box">
                        {% trans 'Total of fields 5 + 7:' %}</label></th>
                    <td width="30%" class="green-bg required-input"><input tabindex="90" autocomplete="off" class="green-bg form-control" id="id_total_of_cancelled_ballots_and_ballots_inside_box" name="total_of_cancelled_ballots_and_ballots_inside_box" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
                </tr>
		    </tbody>
		</table>
        </div>
        <div class="col-md-2 col-sm-1 grid2 righter">
           <table class="table table-bordered">
		<tbody>
		<tr>
            <th width="10%"><span class="bignum">2</span></th>
            <th width="60%"><label for="id_number_of_voter_cards_in_the_ballot_box">
                <span class="helptext">
                    {% trans 'Number of voter cards in the ballot box:' %}</span></label></th>
            <td width="30%"class="green-bg required-input"><input tabindex="20" autocomplete="off" class="green-bg form-control" id="id_number_of_voter_cards_in_the_ballot_box" name="number_of_voter_cards_in_the_ballot_box" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
		</tbody>
		</table>
        </div>
    </div>
	<div class="row">
        <div class="col-md-2 col-sm-1 grid2">
            <p class="gray-bg">
            {% trans 'Section (E) to be filled in after completing the results forms' %}</p>
            <table class="table table-bordered">
            <tbody>
            <tr>
                <th width="10%"><span class="bignum">10</span></th>
                <th width="60%"><label for="id_number_unstamped_ballots">
                    {% trans 'Number of unstamped ballots:' %}</label></th>
                <td width="30%" class="blue-bg required-input"><input tabindex="100" autocomplete="off" class="blue-bg form-control" id="id_number_unstamped_ballots" name="number_unstamped_ballots" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <th><span class="bignum">11</span></th>
                <th><label for="id_number_invalid_votes">
                    {% trans 'Number of invalid votes (including empty ballot papers):' %}</label></th>
                <td class="blue-bg required-input"><input tabindex="110" autocomplete="off" class="blue-bg form-control" id="id_number_invalid_votes" name="number_invalid_votes" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <th><span class="bignum">12</span></th>
                <th><label for="id_number_valid_votes">
                    {% trans 'Number of valid votes:' %}</label></th>
                <td class="blue-bg required-input"><input tabindex="120" autocomplete="off" class="blue-bg form-control" id="id_number_valid_votes" name="number_valid_votes" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <th><span class="bignum">13</span></th>
                <th><label for="id_number_sorted_and_counted">
                    {% trans 'Total number of the sorted and counted ballots (10 + 11 + 12):' %}</label></th>
                <td class="blue-bg required-input"><input tabindex="130" autocomplete="off" class="blue-bg form-control" id="id_number_sorted_and_counted" name="number_sorted_and_counted" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/><br/></td>
            </tr>
            <tr>
                <td colspan="3" class="blue-bg">
                    {% trans 'NB: If the number in field 2 is not equal to the number in field 9, the result should be recalculated in fields 5, 7.' %}
                    <br/>
                    <br/>
                    {% trans 'If the difference remains after the recalculation, the cancelled ballot papers and ballot papers in the box shall be recounted in fields 5 and 7.' %}
                    <br/>
                    <br/>
                    {% trans 'If the difference remains, write a note in the box below the form, stating the procedures followed before proceeding to the next step.' %}
                    <br/>
                    <br/>
                    {% trans 'If the number in field 13 is not equal to the number in field 7, the result should be recalculated in fields 10, 11, and 12.' %}
                    <br/>
                    <br/>
                    {% trans 'If the difference remains after the recalculation, the ballot papers shall be recounted in fields 10, 11 , and 12 as indicated in the procedures manual.' %}
                    <br/>
                    <br/>
                    {% trans 'If the difference remains, write a note in the box below the form, stating the procedures followed before proceeding to the next step.' %}
                </td>
            </tr>
            <tr><th></th><th><label for="id_signature_polling_officer_1">{% trans 'Is the form signed by polling officer 1?' %}</label></th>
                <td><input tabindex="140" autocomplete="off" class="form-control" id="id_signature_polling_officer_1" name="signature_polling_officer_1" onCopy="return false;" onDrag="return false;" onDrop="return false;" onPaste="return false;" type="checkbox" /></td></tr>
            <tr><th></th><th><label for="id_signature_polling_officer_2">{% trans 'Is the form signed by polling officer 2?' %}</label></th>
                <td><input tabindex="150" autocomplete="off" class="form-control" id="id_signature_polling_officer_2" name="signature_polling_officer_2" onCopy="return false;" onDrag="return false;" onDrop="return false;" onPaste="return false;" type="checkbox" /></td></tr>
            <tr><th></th><th><label for="id_signature_polling_station_chair">{% trans 'Is the form signed by the polling station chair?' %}</label></th>
                <td><input tabindex="160" autocomplete="off" class="form-control" id="id_signature_polling_station_chair" name="signature_polling_station_chair" onCopy="return false;" onDrag="return false;" onDrop="return false;" onPaste="return false;" type="checkbox" /></td></tr>
            <tr><th></th><th><label for="id_signature_dated">{% trans 'Is the form dated?' %}</label></th>
                <td><input tabindex="170" autocomplete="off" class="form-control" id="id_signature_dated" name="signature_dated" onCopy="return false;" onDrag="return false;" onDrop="return false;" onPaste="return false;" type="checkbox" /></td></tr>
            <tr><th></th><th><label for="id_is_stamped">{% trans 'Is the form stamped?' %}</label></th>
                <td><input tabindex="180" autocomplete="off" class="form-control" id="id_is_stamped" name="is_stamped" onCopy="return false;" onDrag="return false;" onDrop="return false;" onPaste="return false;" type="checkbox" /><br /></td></tr>
            </tbody>
            </table>
            </div>

            <div class="col-md-2 col-sm-1 grid2 righter">
                <p class="gray-bg">
            {% trans 'Section (C) to be filled in upon closing the station' %}
                </p>
            <table class="table table-bordered">
            <tbody>
            <tr>
                <th><span class="bignum">3</span></th>
                <th><label for="id_number_unused_ballots">
                        {% trans 'Number of unused ballots:' %}</label></th>
                <td class="yellow-bg required-input"><input tabindex="30" autocomplete="off" class="yellow-bg form-control" id="id_number_unused_ballots" name="number_unused_ballots" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <th><span class="bignum">4</span></th>
                <th><label for="id_number_spoiled_ballots">
                    {% trans 'Number of spoiled ballots:' %}</label></th>
                <td class="yellow-bg required-input"><input tabindex="40" autocomplete="off" class="yellow-bg form-control" id="id_number_spoiled_ballots" name="number_spoiled_ballots" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <th><span class="bignum">5</span></th>
                <th><label for="id_number_cancelled_ballots">
                    {% trans 'Number of cancelled ballots:' %}</label></th>
                <td class="yellow-bg required-input"><input tabindex="50" autocomplete="off" class="yellow-bg form-control" id="id_number_cancelled_ballots" name="number_cancelled_ballots" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <th><span class="bignum">6</span></th>
                <th><label for="id_number_ballots_outside_box">
                    {% trans 'Total number of ballots remaining outside the ballot box (3 + 4 + 5):' %}</label></th>
                <td class="yellow-bg required-input"><input tabindex="60" autocomplete="off" class="yellow-bg form-control" id="id_number_ballots_outside_box" name="number_ballots_outside_box" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"></td>
            </tr>
            </tbody>
            </table>
            <p class="gray-bg">
            {% trans 'Section (D) to be completed after counting the ballot papers in the ballot box' %}</p>
            <table class="table table-bordered">
            <tbody>
            <tr>
                <th width="10%"><span class="bignum">7</span></th>
                <th width="60%"><label for="id_number_ballots_inside_box">
                    {% trans 'Number of ballots found inside the ballot box:' %}</label></th>
                <td class="blue-bg required-input" width="30%"><input tabindex="70" autocomplete="off" class="blue-bg form-control" id="id_number_ballots_inside_box" name="number_ballots_inside_box" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <th><span class="bignum">8</span></th>
                <th><label for="id_number_ballots_inside_and_outside_box">
                    {% trans 'Total number of ballots found inside and outside the ballot box (6 + 7):' %}</label></th>
                <td class="pink-bg required-input"><input tabindex="80" autocomplete="off" class="pink-bg form-control" id="id_number_ballots_inside_and_outside_box" name="number_ballots_inside_and_outside_box" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;" type="text"/></td>
            </tr>
            <tr>
                <td class="pink-bg" colspan="3">
                    {% trans 'N.B. if the figure in field 8 does not equal the figure in field 1, the calculations above should be redone.' %}
                    <br/>
                    <br/>
                    {% trans 'If the difference persists, the ballots should be recounted to verify the figures in the fields 3, 4, 5, 7.' %}
                    <br/>
                    <br/>
                    {% trans 'If the difference persists, write a note in the field at the bottom of the form to explain the action taken prior to proceeding to the next step.' %}
                </td>
            </tr>
            </tbody>
            </table>
            <table class="table">
            <tbody>
            <tr>
                <td width="60%"><textarea rows="14" placeholder="If needed, use this field for any necessary notes." cols="50" tabindex="190" autocomplete="off" class="form-control" id="id_notes" name="notes" oncopy="return false;" ondrag="return false;" ondrop="return false;" onpaste="return false;"></textarea></td>
                </tr>
            </tbody>
            </table>
        </div>
    </div>
    {% endif %}

	<div class="row border-top"></div>

    <h2>{% trans 'Results Section' %}</h2>

    {{ formset.non_form_errors }}
    {{ formset.management_form }}
    <table class="table table-bordered mid">
        <tbody><tr>
            <th width="10%">{% trans 'No.' %}</th>
            <th width="60%">{% trans 'Candidate' %}</th>
            <th width="30%">{% trans 'Votes' %}</th>
        </tr>
    {% for election_level, sub_race_type, form, candidate in forms_and_candidates %}
        <tr>
            <td>
                {{ candidate.order }}
            </td>
            <td>
                {{ candidate.full_name }}
            </td>
            <td>
                {{ form.as_p }}
            </td>
        </tr>
    {% endfor %}
    </table>

    <input type="hidden" name="result_form" value="{{ result_form.pk }}">
    <button tabindex="1000" class="btn btn-primary" type="submit" name="submit">{% trans "Submit" %}</button>
    {% csrf_token %}
</form>
{% endblock %}

{% block javascript %}
<script type="text/javascript" src="{{ STATIC_URL }}js/blank_field_check.js"></script>
{% endblock %}
